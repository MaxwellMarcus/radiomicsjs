import createWebWorkerPromise from '../core/internal/createWebWorkerPromise.js';
import { readAsArrayBuffer } from 'promise-file-reader';
import config from '../itkConfig.js';
async function readMeshFile(webWorker, file) {
    let worker = webWorker;
    const { webworkerPromise, worker: usedWorker } = await createWebWorkerPromise('mesh-io', worker);
    worker = usedWorker;
    const arrayBuffer = await readAsArrayBuffer(file);
    try {
        const mesh = await webworkerPromise.postMessage({
            operation: 'readMesh',
            name: file.name,
            type: file.type,
            data: arrayBuffer,
            config: config
        }, [arrayBuffer]);
        return { mesh, webWorker: worker };
    }
    catch (error) {
        throw Error(error.toString());
    }
}
export default readMeshFile;
